function initJsTree(){$("#jsTreeTargets div").each(function(){var e="#"+$(this).attr("id");$(e).jstree({core:{themes:{name:"proton",dots:!1,responsive:!0,icons:!1}},types:{valid_children:["ml"],types:{default:{valid_children:["default"]}}},plugins:["themes","html_data","ui","checkbox","types","changed","search"]}).on("changed.jstree ",function(e,a){countSelectedTargets(),$("#broadcast_message_targets").val("");var t=getSelectedTargets();0!=t.length&&$("#broadcast_message_targets").val(t)})})}function getPredefinedBroadcast(e){$.ajax({type:"POST",url:e,beforeSend:function(){$("#modalPredefined").modal(),$("#modalPredefined  #modal-body").html("<span class='loader-middle'></span>")},complete:function(e){$("#modalPredefined  #modal-body").html(e.responseText).remove(".loader-middle"),$("#modalPredefined").modal()},error:function(e){$("#modalPredefined  #modal-body").html(e.status+" : "+e.responseText)}})}function verifyBeforeSendBd(e){var a=getSelectedTargets();0==a.length?($("#counter").parents("span").removeClass("badge-primary").addClass("badge-danger"),0==$("#targetError").length&&$("#jsTreeTargets").after("<div id='targetError' class='card card-danger card-body'><p style='color:#a94442; font-weight:bold;'>You must selected at least one target to send your mail</p></div>")):$("#formContactEGI").valid()&&($.ajax({type:"POST",dataType:"json",url:e,data:{targets:a.join(",")},beforeSend:function(){$("#modalVerify #SummaryBdbody #targetsList").html("")},success:function(e){$.each(e.targets,function(e,a){if($.isArray(a.item)){var t=!1;$.each(a.item,function(e,a){if(0<=a.indexOf("all")||0<=a.indexOf("global"))return!(t=!0)}),$("#modalVerify #SummaryBdbody #targetsList").append("<p id='"+e.replace(/ /g,"").replace(/-/g,"")+"'><strong>["+a.label+"]</strong>&nbsp;&nbsp;</p>"),t?$("#modalVerify #SummaryBdbody #targetsList #"+e.replace(/ /g,"").replace(/-/g,"")).append("all"):$.each(a.item,function(){$("#modalVerify #SummaryBdbody #targetsList #"+e.replace(/ /g,"").replace(/-/g,"")).append(this+", ")})}else $("#modalVerify #SummaryBdbody #targetsList #"+e.replace(/ /g,"").replace(/-/g,"")).append(this)})},error:function(e){$("#modalVerify #SummaryBdbody #targetsList").text(e.status+" : "+e.responseText)}}),$("#modalVerify #SummaryBdbody #verifName").text($("#broadcast_message_author_cn").val()),$("#modalVerify #SummaryBdbody #verifMail").text($("#broadcast_message_author_email").val()),$("#modalVerify #SummaryBdbody #verifCC").text(""==$("#broadcast_message_cc").val()?"No CC":$("#broadcast_message_cc").val()),$("#modalVerify #SummaryBdbody #verifConfirm").text(1==$("#broadcast_message_confirmation").val()?"yes":"no"),$("#modalVerify #SummaryBdbody #verifPubType").text($("#broadcast_message_publication_type option:selected").text()),$("#modalVerify #SummaryBdbody #verifSubject").text($("#broadcast_message_subject").val()),$("#modalVerify #SummaryBdbody #verifBody").html($("#broadcast_message_body").val().replace(/[\n\r]/g,"<br>")),$("#modalVerify").modal("show"))}function sendMailContactEGICommunities(){$(".loader-wrapper").show(),$(".loader-wrapper .loader").show(),$("#formContactEGI").submit()}function showTrDetail(e,a,t){var r='# style="font-size: 24px;"_'+a+"_"+t;$(r).is(":visible")?($(r).slideUp("slow"),$(e).find(".fa").removeClass("fa-minus").addClass("fa-plus")):($(r).slideDown("slow"),$(e).find(".fa").removeClass("fa-plus").addClass("fa-minus"))}function getSelectedTargets(){var t=[];return $("#jsTreeTargets div").each(function(){var e="#"+$(this).attr("id"),a=$(e).jstree("get_selected");0!=a.length&&(a=a.filter(function(e){return!!~e.indexOf("all")||!~e.indexOf("all")}),t.push(a))}),t}