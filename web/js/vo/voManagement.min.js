function affMasqBtnPrep(){$("input:checked[name='prep[]']").length<1?$("#btnRegistration").addClass("disabled"):$("#btnRegistration").removeClass("disabled")}function checkVoRegistration(){$("#registrationWelcome").slideUp("slow"),$("#registration").slideDown("slow")}function changeRelationship(){var e=$("#vo_VoAcknowledgmentStatements_use_relationShip").is(":checked"),t=$("#use_relationship");1==e?($(t).show(),$(t).children().removeAttr("disabled")):($(t).hide(),$(t).children().attr("disabled","disabled"))}function filterAupDisplay(){switch($("#vo_VoHeader_aup_type").val()){case"File":$("#aup_url_block").hide(),$("#vo_VoHeader_aupUrl").removeAttr("required"),$("#aup_text_block").hide(),$("#vo_VoHeader_aupText").removeAttr("required"),$("#aup_file_block").show(),$("#vo_VoHeader_aupFile_name").attr("required","required");break;case"Url":$("#aup_text_block").hide(),$("#vo_VoHeader_aupText").removeAttr("required"),$("#aup_file_block").hide(),$("#vo_VoHeader_aupFile_name").removeAttr("required"),$("#aup_url_block").show(),$("#vo_VoHeader_aupUrl").attr("required","required");break;case"Text":$("#aup_url_block").hide(),$("#vo_VoHeader_aupUrl").removeAttr("required"),$("#aup_file_block").hide(),$("#vo_VoHeader_aupfile_name").removeAttr("required"),$("#aup_text_block").show(),$("#vo_VoHeader_aupText").attr("required","required"),""==$("#vo_VoHeader_aupText").text()&&$("#vo_VoHeader_aupText").text("This Acceptable Use Policy applies to all members of [VoName] Virtual Organisation, \nhereafter referred to as the [VO], with reference to use of the EGI Infrastructure. \nThe [owner body] owns and gives authority to this policy. \nGoal and description of the [VONAME] VO \n--------------------------------------------------------------------- \n[TO be completed] \nMembers and Managers of the [VO] agree to be bound by the Acceptable Usage Rules, [VO] Security Policy and other relevant EGI Policies, and to use the Infrastructure only in the furtherance of the stated goal of the [VO].")}}function entityAction(e,t,a,i){$("#header").slideUp("slow"),$.ajax({type:"POST",data:{id:a,serial:t},url:e,async:!1,complete:function(e){$("#divModal"+i).empty(),$("#divModal"+i).append(e.responseText),$("#modal"+i).modal({backdrop:"static",keyboard:!1})}})}function saveEntityAction(e,a){event.preventDefault(),$.ajax({type:"POST",dataType:"html",data:$("#"+a+"Form :input").serialize(),url:e,success:function(e,t){$("#panel"+a).html(e)},complete:function(){$("#header").slideDown("slow")}}),$("#modal"+a).modal("toggle")}function deleteEntityAction(e,t,a,i,o){if(!confirm("Do you really want to delete "+i+"?"))return!1;$.ajax({type:"get",dataType:"html",data:{id:a,serial:t},url:e,success:function(e,t){$("#"+o).html(e)}})}function deleteContactHasProfil(e,t,a,i,o,n){if(!confirm("Do you really want to delete "+i+"?"))return!1;1<$("#contactTable .vomanager").length||"VO MANAGER"!=n?$.ajax({type:"get",dataType:"html",data:{id:a,serial:t},url:e,success:function(e,t){$("#"+o).html(e)}}):alert("You can not delete the last VO MANAGER")}function askForPerun(e,t,a){null!=t&&""!=t&&$.isNumeric(t)?$.ajax({type:"post",dataType:"html",data:{serial:t},url:e,beforeSend:function(){$("#askForPerun").attr("disabled","disabled").html("<span class='loader-little'></span>")},success:function(e){$("#"+a).html(e)},complete:function(){$("#askForPerun").removeAttr("disabled").html("Ask to use it")}}):$("#askForPerun").after("<span style='color:red'>No VO serial !</span>")}function editEndpoint(e,t){addEditEndpoint("edit",t),$(".modal-title").html("Edit endpoint"),$("#cvmfs").val(e),$("#modalCvmfs").modal({keyboard:!1})}function removeEndpoint(e){$("#tabcvmfs").DataTable().row(e).remove().draw(),$("html,body").animate({scrollTop:$("#cvmfsSection").offset().top-200},"slow")}function buildMemberListUrl(e,t){var a="https://%%HOST%%:%%PORT%%/voms/%%VONAME%%/services/VOMSAdmin?method=listMembers",i=$("#"+e+"_hostname").val(),o=$("#"+e+"_https_port").val(),n=$("#"+t+"_name").val();a=(a=(a=a.replace("%%VONAME%%",n)).replace("%%HOST%%",i)).replace("%%PORT%%",o),$("#"+e+"_members_list_url").val(a)}$(document).ready(function(){affMasqBtnPrep(),$(".checkboxRegistration").change(function(){affMasqBtnPrep()}),$("#vo_VoHeader_name").on("input",function(){$("#alreadyUsedName").remove()}),$("#voForm").validate(),$("#voForm").submit(function(t){0==$("#vo_VoHeader_serial").length&&$.ajax({type:"POST",dataType:"json",data:{name:$("#vo_VoHeader_name").val()},url:$("footer").text(),async:!1,success:function(e){e.checkedName?($("html, body").animate({scrollTop:0},"slow"),0==$("#alreadyUsedName").length&&$("#vo_VoHeader_name").after('<label id="alreadyUsedName" style="color: #cd0a0a">This vo name has already been used, please enter another Vo name.</label>'),t.preventDefault()):$("#alreadyUsedName").remove()},error:function(){t.preventDefault()}});var e=$("#vo_VoHeader_aup_type").val();$("#vo_VoHeader_aup").val($("#vo_VoHeader_aup"+e).val()),$("#voForm").valid()||t.preventDefault(),$("#listdisciplines :input").length<1&&(alert("please select at least one discipline"),t.preventDefault()),$("#supportedServices :checked").length<1&&(alert("please select at least one Supported Service"),t.preventDefault());var a=[];$("#tabcvmfs").DataTable().data().any()?($("#tabcvmfs tbody tr td:first-child").each(function(){a.push($(this).text())}),$("#vo_VoRessources_cvmfs").val(a)):$("#vo_VoRessources_cvmfs").val(null)}),$("#vo_VoHeader_vo_scope").val($("#vo_VoHeader_scope_id").val()),filterAupDisplay(),""!=$("#vo_VoAcknowledgmentStatements_relationShip").val()&&($("#vo_VoAcknowledgmentStatements_use_relationShip").attr("checked","checked"),changeRelationship()),$("#vo_VoAcknowledgmentStatements_suggested").text("This work benefited from services provided by the [VO] Virtual Organisation, supported by the national resource providers of the EGI Federation"),$("#disciplines").jstree({plugins:["wholerow","checkbox","search"],core:{themes:{name:"proton",responsive:!0,icons:!1},data:$(".viewDisciplines").val()},checkbox:{three_state:!1,cascade:""}}).on("changed.jstree",function(e,t){if("select_node"==t.action){var a=t.node.parent;void 0!==a&&"#"!==a?($("#listdisciplines").find("#ul_"+a).length||$("#disciplines").find("#"+a).children("a").click(),$("#listdisciplines").find("#ul_"+a).append("<li parent='"+a+"' id='"+t.node.id+"'><input name='VoDiscipline["+t.node.id+"]' type='hidden' value='"+t.node.text+"'/>"+t.node.text+"</li><ul id='ul_"+t.node.id+"'></ul>")):$("#listdisciplines").append("<li class='first' id='"+t.node.id+"'><input name='VoDiscipline["+t.node.id+"]' type='hidden' value='"+t.node.text+"'/>"+t.node.text+"</li><ul id='ul_"+t.node.id+"'></ul>")}else $("#listdisciplines").find("#ul_"+t.node.id).find("li[parent="+t.node.id+"]").each(function(e,t){$("#disciplines").find("#"+$(t).attr("id")).children("a").click()}),$("#listdisciplines").find("#"+t.node.id).remove(),$("#listdisciplines").find("#ul_"+t.node.id).remove()});var e=!1;$("#disciplines_q").keyup(function(){e&&clearTimeout(e),e=setTimeout(function(){var e=$("#disciplines_q").val();$("#disciplines").jstree(!0).search(e)},250)}),$(".disciplineId").each(function(e){$("#disciplines").find("#"+$(this).val()).children("a").click()})});